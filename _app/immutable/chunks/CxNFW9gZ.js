import{f as p,a as f}from"./xhJEdZQq.js";import{i as X}from"./Dgg8FQQQ.js";import{o as Z}from"./v5Ghx0Jz.js";import{v as ee,z as te,o as r,q as a,u as s,B as ie,y as N,g as e,m as I,A as se,s as _,an as ve,w as le,x as ne,C as ce}from"./C3Hdb8d4.js";import{s as j,e as Q,r as me}from"./BY-y2o2q.js";import{i as V}from"./BMk0_yKg.js";import{e as J,i as R,s as ue,b as ae}from"./BH1KgleA.js";import{s as de,b as fe}from"./DEkdmhtJ.js";import{s as _e,a as pe}from"./BaltXBWv.js";import{i as be,u as ge,l as W}from"./C2hnSsbc.js";function he(i){return function(...u){var w=u[0];return w.preventDefault(),i==null?void 0:i.apply(this,u)}}const re="https://script.google.com/macros/s/AKfycbyotR1wfxMBzm-u_kYICmtJsjUHOvdEEUu9wj75xcp5CAnH-uVYFSO_KzQ9SFmAYTiI/exec";async function ye(i){try{const u=await fetch(re,{method:"POST",body:JSON.stringify({action:"add",...i})});return console.log("test"),await u.json()}catch(u){throw console.error("Error adding comment:",u),u}}async function je(){try{return await(await fetch(re,{method:"POST",body:JSON.stringify({action:"get"})})).json()}catch(i){throw console.error("Error fetching comments:",i),i}}var xe=p("<option> </option>"),we=p('<button type="button">⭐</button>'),Ce=p('<div class="user-info svelte-3mv5ju"><img alt="Profile" class="svelte-3mv5ju"/> <span> </span></div> <form><div class="form-group svelte-3mv5ju"><label for="subject" class="svelte-3mv5ju">เลือกวิชา:</label> <select id="subject" required class="svelte-3mv5ju"><option>-- เลือกวิชา --</option><!></select></div> <div class="form-group svelte-3mv5ju"><label for="rating" class="svelte-3mv5ju">คะแนนความพึงพอใจ:</label> <div class="rating svelte-3mv5ju"><!> <span> </span></div></div> <div class="form-group svelte-3mv5ju"><label for="comment" class="svelte-3mv5ju">ความคิดเห็น:</label> <textarea id="comment" placeholder="แสดงความคิดเห็นเกี่ยวกับวิชานี้..." rows="4" required class="svelte-3mv5ju"></textarea></div> <button type="submit" class="submit-btn svelte-3mv5ju">ส่งความคิดเห็น</button></form>',1),Se=p('<div class="login-prompt svelte-3mv5ju"><p>กรุณาเข้าสู่ระบบด้วย LINE เพื่อแสดงความคิดเห็น</p> <button class="login-btn svelte-3mv5ju">เข้าสู่ระบบด้วย LINE</button></div>'),Oe=p('<div class="comment-form svelte-3mv5ju"><h2 class="svelte-3mv5ju">แสดงความคิดเห็นเกี่ยวกับวิชาเรียน</h2> <!></div>');function Re(i,u){ee(u,!1);const[w,L]=_e(),b=()=>pe(ge,"$userProfile",w);let o=I(""),C=I(""),S=I(5),Y=["Creative Class","167-ธุรกิจ Online","หลักการโปรแกรมคอมพิวเตอร์ทางธุรกิจและเทคโนโลยีดิจิทัล","267-การจัดการฐานข้อมูล","การพัฒนาแอพพลิเคชั่นทางธุรกิจ"];Z(async()=>{await be()});async function B(){if(!b()){await W();return}if(!e(o)||!e(C).trim()){alert("กรุณากรอกข้อมูลให้ครบถ้วน");return}try{const l={userId:b().userId,displayName:b().displayName,subject:e(o),comment:e(C).trim(),rating:e(S)};(await ye(l)).success&&(_(o,""),_(C,""),_(S,5),alert("ส่งคอมเม้นต์เรียบร้อย!"))}catch(l){console.error(l),alert("เกิดข้อผิดพลาด กรุณาลองใหม่")}}X();var O=Oe(),T=r(a(O),2);{var k=l=>{var g=Ce(),t=ie(g),n=a(t),v=r(n,2),P=a(v);s(v),s(t);var c=r(t,2),h=a(c),q=r(a(h),2);N(()=>{e(o),se(()=>{})});var y=a(q);y.value=y.__value="";var z=r(y);J(z,1,()=>Y,R,(d,x)=>{var m=xe(),H={},M=a(m,!0);s(m),N(()=>{H!==(H=e(x))&&(m.value=(m.__value=e(x))??""),j(M,e(x))}),f(d,m)}),s(q),s(h);var E=r(h,2),$=r(a(E),2),U=a($);J(U,0,()=>[1,2,3,4,5],R,(d,x)=>{var m=we();N(()=>ue(m,1,`star ${x<=e(S)?"active":""}`,"svelte-3mv5ju")),Q("click",m,()=>_(S,x)),f(d,m)});var D=r(U,2),K=a(D);s(D),s($),s(E);var A=r(E,2),F=r(a(A),2);me(F),s(A),ve(2),s(c),N(()=>{de(n,"src",b().pictureUrl),j(P,`สวัสดี ${b().displayName??""}`),j(K,`${e(S)??""}/5`)}),ae(q,()=>e(o),d=>_(o,d)),fe(F,()=>e(C),d=>_(C,d)),Q("submit",c,he(B)),f(l,g)},G=l=>{var g=Se(),t=r(a(g),2);s(g),Q("click",t,function(...n){var v;(v=W)==null||v.apply(this,n)}),f(l,g)};V(T,l=>{b()?l(k):l(G,!1)})}s(O),f(i,O),te(),L()}var Ee=p("<option> </option>"),Ne=p('<div class="loading svelte-1vsn6oe">กำลังโหลด...</div>'),Ie=p('<div class="no-comments svelte-1vsn6oe">ยังไม่มีความคิดเห็น</div>'),Le=p('<div class="comment-card svelte-1vsn6oe"><div class="comment-header svelte-1vsn6oe"><div class="user-name svelte-1vsn6oe"> </div> <div class="subject-tag svelte-1vsn6oe"> </div> <div class="timestamp svelte-1vsn6oe"> </div></div> <div class="rating svelte-1vsn6oe"> </div> <div class="comment-text svelte-1vsn6oe"> </div></div>'),Pe=p('<div class="comments"></div>'),$e=p('<div class="comments-list svelte-1vsn6oe"><h2 class="svelte-1vsn6oe">ความคิดเห็นจากนักเรียน</h2> <div class="filter svelte-1vsn6oe"><label for="subject-filter">กรองตามวิชา:</label> <select id="subject-filter" class="svelte-1vsn6oe"></select></div> <!></div>');function Ye(i,u){ee(u,!1);const w=I();let L=I([]),b=I(!0),o=I("");const C=["ทั้งหมด","Creative Class","167-ธุรกิจ Online","หลักการโปรแกรมคอมพิวเตอร์ทางธุรกิจและเทคโนโลยีดิจิทัล","267-การจัดการฐานข้อมูล","การพัฒนาแอพพลิเคชั่นทางธุรกิจ"];Z(async()=>{await S()});async function S(){try{_(b,!0);const t=await je();t.success&&_(L,t.data.reverse())}catch(t){console.error("Error loading comments:",t)}finally{_(b,!1)}}function Y(t){return new Date(t).toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}function B(t){return"⭐".repeat(t)+"☆".repeat(5-t)}le(()=>(e(o),e(L)),()=>{_(w,e(o)&&e(o)!=="ทั้งหมด"?e(L).filter(t=>t.subject===e(o)):e(L))}),ne(),X();var O=$e(),T=r(a(O),2),k=r(a(T),2);N(()=>{e(o),se(()=>{})}),J(k,5,()=>C,R,(t,n)=>{var v=Ee(),P={},c=a(v,!0);s(v),N(()=>{P!==(P=e(n))&&(v.value=(v.__value=e(n))??""),j(c,e(n))}),f(t,v)}),s(k),s(T);var G=r(T,2);{var l=t=>{var n=Ne();f(t,n)},g=(t,n)=>{{var v=c=>{var h=Ie();f(c,h)},P=c=>{var h=Pe();J(h,5,()=>e(w),R,(q,y)=>{var z=Le(),E=a(z),$=a(E),U=a($,!0);s($);var D=r($,2),K=a(D,!0);s(D);var A=r(D,2),F=a(A,!0);s(A),s(E);var d=r(E,2),x=a(d,!0);s(d);var m=r(d,2),H=a(m,!0);s(m),s(z),N((M,oe)=>{j(U,e(y).displayName),j(K,e(y).subject),j(F,M),j(x,oe),j(H,e(y).comment)},[()=>Y(e(y).timestamp),()=>B(e(y).rating)],ce),f(q,z)}),s(h),f(c,h)};V(t,c=>{e(w).length===0?c(v):c(P,!1)},n)}};V(G,t=>{e(b)?t(l):t(g,!1)})}s(O),ae(k,()=>e(o),t=>_(o,t)),f(i,O),te()}export{Re as C,Ye as a};
